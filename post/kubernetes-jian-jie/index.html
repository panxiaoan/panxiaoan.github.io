<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Kubernetes：简介 01 | 行走在年轮之上</title>
<meta name="description" content="她就像蒲公英一样的淘气,不,比蒲公英还要淘气。 有许多人多认为她很笨,可是她总觉得自己是最聪明的。 ">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://panxiaoan.github.io/favicon.ico?v=1559270979810">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://panxiaoan.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://panxiaoan.github.io">
        <img src="https://panxiaoan.github.io/images/avatar.png?v=1559270979810" class="site-logo">
        <h1 class="site-title">行走在年轮之上</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/panxiaoan" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
          <a class="social-link" href="https://www.zhihu.com/people/panningbo/activities" target="_blank">
            <i class="fab fa-zhihu"></i>
          </a>
        
      
        
      
    </div>
    <div class="site-description">
      她就像蒲公英一样的淘气,不,比蒲公英还要淘气。 有许多人多认为她很笨,可是她总觉得自己是最聪明的。 
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/panxiaoan" target="_blank">潘小安</a> | <a class="rss" href="https://panxiaoan.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Kubernetes：简介 01</h2>
            <div class="post-date">2019-05-31</div>
            
            <div class="post-content">
              <h1 id="kubernetes-简介">Kubernetes 简介</h1>
<p>Kubernetes 是<code>Google</code> 基于 <code>Borg</code> 开源的容器编排调度引擎，作为<code>CNCF</code>（Cloud Native Computing Foundation）最重要的组件之一，它的目标<code>不仅仅是一个编排系统，而是提供一个规范</code>，可以让你来描述集群的架构，定义服务的最终状态，kubernetes 可以帮你将系统自动地达到和维持在这个状态。Kubernetes 作为云原生应用的基石，相当于一个<code>云操作系统</code>，其重要性不言而喻。</p>
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/ce357138-1474-4649-aee1-16ea05374fde/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372011&Signature=LUMj%2BI9OXMyI%2BTW1Dce1xxyvYS4%3D" />
图片转载
<h2 id="历史">历史</h2>
<ul>
<li>Kubernetes 最初源于谷歌内部的 Borg，提供了面向应用的容器集群部署和管理系统</li>
<li>Kubernetes 的目标旨在消除编排物理/虚拟计算，网络和存储基础设施的负担，并使应用程序运营商和开发人员完全将重点放在以容器为中心的原语上进行自助运营。</li>
<li>Kubernetes 也提供稳定、兼容的基础（平台），用于构建定制化的 workflows 和更高级的自动化任务。</li>
<li>Kubernetes 具备完善的集群管理能力：
<ul>
<li>多层次的安全防护和准入机制</li>
<li>多租户应用支撑能力</li>
<li>透明的服务注册和服务发现机制</li>
<li>内建负载均衡器</li>
<li>故障发现和自我修复能力</li>
<li>服务滚动升级和在线扩容</li>
<li>可扩展的资源自动调度机制</li>
<li>多粒度的资源配额管理能力</li>
</ul>
</li>
<li>Kubernetes 还提供完善的管理工具，涵盖开发、部署测试、运维监控等各个环节</li>
</ul>
<h2 id="borg-简介">Borg 简介</h2>
<p>Borg 是谷歌内部的大规模集群管理系统，负责对谷歌内部很多核心服务的调度和管理。Borg的目的是让用户能够不必操心资源管理的问题，让他们专注于自己的核心业务，并且做到跨多个数据中心的资源利用率最大化。</p>
<p>Borg 主要由 BorgMaster、Borglet、borgcfg 和 Scheduler组成，如下图所示</p>
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/624871b3-0ca7-4525-ba85-9df75614292d/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372011&Signature=2WU8nHR2WxGCdDNprBf8E7S7RFk%3D" />
图片转载
<ul>
<li>BorgMaster 是整个集群的大脑，负责维护整个集群的状态，并将数据持久化到Paxos存储中；</li>
<li>Scheduer 负责任务的调度，根据应用的特点将其调度到具体的机器上去；</li>
<li>Borglet 负责真正运行任务（在容器中）；</li>
<li>borgcfg 是 Borg 的命令行工具，用于跟 Borg 系统交互，一般通过一个配置文件来提交任务。</li>
</ul>
<h1 id="kubernetes-架构">Kubernetes 架构</h1>
<p>Kubernetes 借鉴了 Borg 的设计理念，比如 Pod、Service、Labels 和单 Pod、单 IP 等。Kubernetes 的整体架构跟 Borg 非常像，如下图所示：</p>
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/cddf35f5-e78c-4cb1-a9a6-2a954bab8fa4/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372011&Signature=z79lkPLFsGkd8ykneNETbb8nCsY%3D" />
图片转载
<p><strong>Kubernetes主要由以下几个核心组件组成：</strong></p>
<ul>
<li>etcd 保存了整个集群的状态；</li>
<li>apiserver 提供了资源操作的唯一入口，并提供认证、授权、访问控制、API注册和发现等机制；</li>
<li>controller manager 负责维护集群的状态，比如故障检测、自动扩展、滚动更新等；</li>
<li>scheduler 负责资源的调度，按照预定的调度策略将 Pod 调度到相应的机器上；</li>
<li>kubelet 负责维护容器的生命周期，同时也负责 Volume（CSI）和网络（CNI）的管理；</li>
<li>Container runtime 负责镜像管理以及 Pod 和容器的真正运行（CRI）；</li>
<li>kube-proxy 负责为 Service 提供 cluster 内部的服务发现和负载均衡；</li>
</ul>
<p><strong>除了核心组件，还有一些推荐的 Add-ons：</strong></p>
<ul>
<li>kube-dns 负责为整个集群提供DNS服务</li>
<li>Ingress Controller 为服务提供外网入口</li>
<li>Heapster 提供资源监控</li>
<li>Dashboard 提供 Web UI</li>
<li>Federation 提供跨可用区的集群</li>
</ul>
<h2 id="整体架构图">整体架构图</h2>
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/e9a49a30-30eb-42dd-ad1e-7e918fd21982/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372011&Signature=tLBi3WC3laki36djhDOBjNxIfUY%3D" />
图片转载
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/dc93d42b-0e41-440c-a13d-b6492223564a/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372011&Signature=AnVftP%2BBBWU1zQnwEpDB5W4vgkw%3D" />
图片转载
<h2 id="master-架构">Master 架构</h2>
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/0ffa2aed-0ed6-41ad-94a0-41d09e8967c4/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372012&Signature=6VayKG8GB9oiuam%2Bd37wyKABUCA%3D" />
图片转载
<h2 id="node-架构">Node 架构</h2>
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/cc8f0f2f-2f13-4637-be83-88c884efbece/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372012&Signature=GOflyisna2xUXd4OLFyEuNl3RCI%3D" />
图片转载
<h2 id="分层架构">分层架构</h2>
<img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/3c8ab571-b914-474d-83b8-d8c6c522ebe9/Untitled?AWSAccessKeyId=AKIAJLJXUMP5IHUZAPFQ&Expires=1536372012&Signature=I7sdR%2FWj1R0wNOniT1otvpjYkX4%3D" />
<p><strong>Kubernetes 设计理念和功能其实就是一个类似 Linux 的分层架构：</strong></p>
<ul>
<li>核心层：Kubernetes 最核心的功能，对外提供API构建高层的应用，对内提供插件式应用执行环境</li>
<li>应用层：部署（无状态应用、有状态应用、批处理任务、集群应用等）和路由（服务发现、DNS解析等）</li>
<li>管理层：系统度量（如基础设施、容器和网络的度量），自动化（如自动扩展、动态Provision等）以及策略管理（RBAC、Quota、PSP、NetworkPolicy等）</li>
<li>接口层：kubectl命令行工具、客户端SDK以及集群联邦</li>
<li>生态系统：在接口层之上的庞大容器集群管理调度的生态系统，可以划分为两个范畴
<ul>
<li>Kubernetes外部：日志、监控、配置管理、CI、CD、Workflow、FaaS、OTS应用、ChatOps等</li>
<li>Kubernetes内部：CRI、CNI、CVI、镜像仓库、Cloud Provider、集群自身的配置和管理等</li>
</ul>
</li>
</ul>
<h2 id="开发接口">开发接口</h2>
<p>Kubernetes 作为云原生应用的的基础调度平台，相当于云原生的操作系统，为了便于系统的扩展，Kubernetes 中开放的以下接口，可以分别对接不同的后端，来实现自己的业务逻辑：</p>
<ul>
<li><strong>CRI（Container Runtime Interface）</strong>：容器运行时接口，提供计算资源</li>
<li><strong>CNI（Container Network Interface）</strong>：容器网络接口，提供网络资源</li>
<li><strong>CSI（Container Storage Interface</strong>）：容器存储接口，提供存储资源</li>
</ul>
<p>以上三种资源相当于一个分布式操作系统的最基础的几种资源类型，而Kuberentes是将他们粘合在一起的纽带。</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://panxiaoan.github.io/tag/kubernetes" class="tag">
                    kubernetes
                  </a>
                
                  <a href="https://panxiaoan.github.io/tag/k8s" class="tag">
                    k8s
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://panxiaoan.github.io/post/docker-compose-da-jian-jing-xiang-cang-ku">
                  <h3 class="post-title">
                    Docker：Compose 搭建镜像仓库 04
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '778be70d2cb3e47d4e2c',
        clientSecret: '4e9b0fe8ee9cff6b19f7d918b334c557b7db01bf',
        repo: 'blog-comments',
        owner: 'panxiaoan',
        admin: ['panxiaoan'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
